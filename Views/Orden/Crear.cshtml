@{
    ViewData["Title"] = "Crear Nueva Orden De Reparacion";
    var listaClientes = ViewBag.Clientes as List<BibTaller.Clases.EstrucPersona.Cliente>;
    var listaMecanicos = ViewBag.Mecanicos as List<BibTaller.Clases.EstrucPersona.Mecanico>;
    var listaTiposReparacion = ViewBag.TiposReparacion as List<string>;
    var listaTiposVehiculo = ViewBag.TiposVehiculo as List<string>;
    var mensajeError = ViewBag.MensajeError as string;
}

@if (ViewBag.mensajeError != null)
{
    <div id="msg" class="alert alert-danger">@mensajeError</div>

    <script>
        setTimeout(() => document.getElementById("msg")?.remove(), 3000);
    </script>
}


<div class="card-header bg-transparent border-0 text-center pb-3">
    <h4 class="text-success mb-3">Crear Orden de Reparacion</h4>
    <hr />
</div>

<div class="container-fluid py-4">
    <div class="card bg-dark text-light border-0 shadow-sm rounded-3 p-3">

        <div class="card-body px-4 pb-4">
            <form asp-action="CrearOrden" method="post" id="formOrdenReparacion">

                <h5 class="text-success mb-3">Detalles de la Orden</h5>

                <!-- Tipo De Reparacion -->
                <div class="row mb-4 align-items-end">
                    <div class="col-md-6">
                        <label for="tipoReparacion" class="form-label text-success fw-semibold">Tipo De Reparación</label>
                        <select class="form-select bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                id="tipoReparacion" name="TipoReparacion" required>
                            <option value="" selected disabled>Seleccione un tipo de Reparación</option>
                            @if (listaTiposReparacion != null) {
                                foreach (var tipo in listaTiposReparacion) {
                                    <option value="@tipo">@tipo</option>
                                }
                            }
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label for="costoManoObra" class="form-label text-success fw-semibold">Costo Mano De Obra</label>
                        <input type="number" class="form-control bg-dark text-light border-success border-2 rounded-3 focus-glow"
                               id="costoManoObra" name="CostoManoObra" step="0.01" min="0" value="0" required>
                    </div>
                </div>

                <!-- Datos Del Vehiculo -->
                <div class="mb-4">
                    <div class="divider-dashed my-3"></div>
                    <h5 class="text-success mb-3">Datos del Vehiculo</h5>

                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="tipoVehiculo" class="form-label text-success">Tipo De Vehículo</label>
                            <select class="form-select bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                    id="tipoVehiculo" name="TipoVehiculo" required>
                                <option value="" selected disabled>Seleccione un tipo de vehículo</option>
                                @if (listaTiposVehiculo != null) {
                                    foreach (var tipo in listaTiposVehiculo) {
                                        <option value="@tipo">@tipo</option>
                                    }
                                }
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label for="propietario" class="form-label text-success">Propietario</label>
                            <select class="form-select bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                    id="propietario" name="PropietarioId" required>
                                <option value="" selected disabled>Seleccione un cliente</option>
                                @if (listaClientes != null) {
                                    foreach (var cliente in listaClientes) {
                                        <option value="@cliente.Id">@cliente.Nombre</option>
                                    }
                                }
                            </select>
                        </div>
                    </div>

                    <div class="row g-3 mt-3">
                        <div class="col-md-6">
                            <label for="datoVehiculo" class="form-label text-success">Dato Del Vehículo</label>
                            <input type="number" class="form-control bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                   id="datoVehiculo" name="datoVehiculo" min="0" value="0" required>
                        </div>
                        <div class="col-md-6">
                            <label for="placa" class="form-label text-success">Placa</label>
                            <input type="text" class="form-control bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                   id="placa" name="Placa" required>
                        </div>
                    </div>

                    <div class="row g-3 mt-3">
                        <div class="col-md-4">
                            <label for="marca" class="form-label text-success">Marca</label>
                            <input type="text" class="form-control bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                   id="marca" name="Marca" required>
                        </div>
                        <div class="col-md-4">
                            <label for="modelo" class="form-label text-success">Modelo</label>
                            <input type="text" class="form-control bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                   id="modelo" name="Modelo" required>
                        </div>
                        <div class="col-md-4">
                            <label for="anio" class="form-label text-success">Año</label>
                            <input type="number" class="form-control bg-dark text-light border-success border-2 rounded-3 focus-glow"
                                   id="anio" name="Anio" min="1900" max="2099" required>
                        </div>
                    </div>
                </div>

                <!-- Botones -->
                <div class="mt-4 d-flex gap-3 justify-content-end">
                    <a asp-action="Index" class="btn btn-outline-secondary border-2 rounded-3 px-4 btn-cancel">Cancelar</a>
                    <button type="submit" class="btn btn-success border-2 rounded-3 px-5 btn-confirm">Crear Orden</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const tipoVehiculoInput = document.getElementById("tipoVehiculo");
        const labelCampo = document.querySelector("label[for='datoVehiculo']");
        const inputCampo = document.getElementById("datoVehiculo");

        tipoVehiculoInput.addEventListener("input", function () {
            const tipo = tipoVehiculoInput.value.trim().toLowerCase();

            if (tipo === "hibrido") {
                labelCampo.textContent = "Nro Baterías";
                inputCampo.placeholder = "Ingrese el número de baterías";
                inputCampo.type = "number";
            } else if (tipo === "carburado") {
                labelCampo.textContent = "Nro Cilindros";
                inputCampo.placeholder = "Ingrese el número de cilindros";
                inputCampo.type = "number";
            } else if (tipo === "electrico") {
                labelCampo.textContent = "Autonomía Km";
                inputCampo.placeholder = "Ingrese la autonomía en Km";
                inputCampo.type = "number";
            } else {
                labelCampo.textContent = "Dato Específico";
                inputCampo.name = "DatoVehiculo";
                inputCampo.placeholder = "Ingrese un valor";
                inputCampo.type = "text";
            }
        });
    });
</script>

<style>
    body {
        background-color: #0f0f0f;
        color: #d0d0d0;
        font-family: "Segoe UI", sans-serif;
        font-size: 0.93rem;
    }

    .neon-text {
        text-shadow: 0 0 8px #00ff7f;
    }

    .focus-glow:focus {
        box-shadow: 0 0 10px #00ff7f88;
        border-color: #00ff7f;
    }

    .divider-dashed {
        border-top: 1.5px dashed #00ff7f55;
    }

    .btn-cancel {
        color: #ccc;
        border-color: #777;
        transition: all 0.2s ease;
    }

        .btn-cancel:hover {
            background-color: #333;
            color: #fff;
            border-color: #00ff7f;
            box-shadow: 0 0 8px #00ff7f55;
        }

    .btn-confirm {
        background-color: transparent;
        border: 1.5px solid #00ff7f;
        border-radius: 10px;
        color: #00ff7f;
        padding: 6px 14px;
        font-size: 0.9rem;
        font-weight: 600;
        transition: all 0.2s ease;
    }

        .btn-confirm:hover {
            background-color: #00ff7f;
            color: #0f0f0f;
            box-shadow: 0 0 8px #00ff7f;
            transform: translateY(-1px);
        }

    select, input {
        font-size: 0.95rem;
    }
</style>
